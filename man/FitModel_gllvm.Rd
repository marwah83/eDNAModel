% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FitModel_gllvm.R
\name{FitModel_gllvm}
\alias{FitModel_gllvm}
\title{Fit a Multispecies Occupancy–Detection Model using GLLVM and GLMM}
\usage{
FitModel_gllvm(
  phyloseq,
  site_col,
  abundance_rhs,
  occupancy_covars = NULL,
  min_species_sum = 50,
  abundance_threshold = 1,
  n_iter = 50,
  burn_in = 10,
  abundance_family = "poisson"
)
}
\arguments{
\item{phyloseq}{A `phyloseq` object containing OTU count data, sample metadata, and taxonomy.}

\item{site_col}{Character string specifying the name of the column in sample metadata to use as the site identifier.}

\item{abundance_rhs}{A one-sided formula specifying the right-hand side of the abundance model (e.g., `(1 | Samplingmonth/OTU)`).}

\item{occupancy_covars}{Optional character vector specifying covariates to use in the occupancy model.}

\item{min_species_sum}{Integer specifying the minimum total abundance required for an OTU to be retained (default = 50).}

\item{abundance_threshold}{Integer; a threshold of detections above which a taxon is considered present (default = 1).}

\item{n_iter}{Integer; number of Monte Carlo iterations to run (default = 50).}

\item{burn_in}{Integer; number of burn-in iterations to discard (default = 10).}

\item{abundance_family}{Distribution to use for abundance model. One of `"poisson"`, `"nbinom"`, `"zip"`, or `"zinb"`.}
}
\value{
A list with the following components:
\describe{
  \item{summary}{A data frame with posterior summaries of occupancy (`psi_`), abundance (`lambda_`), and detection probability (`p_detect_`).}
  \item{psi_list}{List of occupancy probability estimates across iterations.}
  \item{lambda_list}{List of abundance estimates across iterations (log-scale).}
  \item{p_detect_list}{List of detection probabilities (1 - exp(-lambda)) across iterations.}
  \item{occupancy_models}{List of fitted GLLVM models for occupancy.}
  \item{abundance_models}{List of fitted GLMMs for abundance.}
  \item{reduced_data}{Data frame containing presence/absence data and site/taxon information.}
  \item{lv_sites}{Latent variable coordinates for sites from GLLVM across iterations.}
  \item{lv_species}{Latent variable coordinates for species (OTUs) from GLLVM across iterations.}
  \item{mean_lv_sites}{Averaged site positions in latent variable space (used in biplots).}
  \item{mean_lv_species}{Averaged species positions in latent variable space (used in biplots).}
}
}
\description{
This function implements a hierarchical Bayesian occupancy–detection model
using Generalized Linear Latent Variable Models (GLLVM) for occupancy and 
GLMMs for abundance, iterating between them in a Monte Carlo scheme.
It is specifically designed for analyzing environmental DNA (eDNA) data
structured as a `phyloseq` object.
}
\examples{
\dontrun{
library(phyloseq)
data(GlobalPatterns)
# Replace with real site_col and covariates relevant to your dataset
physeq <- subset_samples(GlobalPatterns, SampleType \%in\% c("Feces", "Mock"))
out <- FitModel_gllvm(
phyloseq = physeq,
site_col = "SampleType",
abundance_rhs = (1 | OTU),
occupancy_covars = c("SampleType"),
abundance_family = "poisson",
n_iter = 10,
burn_in = 2
)
head(out$summary)
}

}
\seealso{
\code{\link[gllvm]{gllvm}}, \code{\link[glmmTMB]{glmmTMB}}
}
