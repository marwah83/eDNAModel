% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_phyloseq_data.R
\name{filter_phyloseq_data}
\alias{filter_phyloseq_data}
\title{Filter and Clean a Phyloseq Object Based on Abundance Thresholds}
\usage{
filter_phyloseq_data(
  phyloseq_obj,
  min_species_sum = 30,
  save_path = "phyloseq_filtered.RDS"
)
}
\arguments{
\item{phyloseq_obj}{A valid `phyloseq` object containing OTU (or ASV) tables, sample metadata, and (optionally) taxonomy.}

\item{min_species_sum}{Integer. Minimum total count threshold across all samples for a taxon (species/OTU) to be retained. Default is 30.}

\item{save_path}{Optional. File path (as character) to save the filtered object as an `.RDS` file. Default: `"phyloseq_filtered.RDS"`. Set to `NULL` to skip saving.}
}
\value{
A filtered `phyloseq` object with:
\itemize{
  \item All-zero species removed
  \item All-zero samples removed
  \item Species with total counts below `min_species_sum` removed
}
}
\description{
This function filters a `phyloseq` object by removing all-zero taxa and samples, and excluding rare taxa based on a minimum abundance threshold. It performs validation checks and optionally saves the filtered object.
}
\details{
The function performs several steps:
\enumerate{
  \item Extracts and reorients the OTU matrix if needed.
  \item Removes all-zero taxa (columns) and all-zero samples (rows).
  \item Filters out taxa with total abundance < `min_species_sum`.
  \item Applies pruning to the original `phyloseq` object to maintain consistency.
  \item Performs internal checks to ensure all-zero entries are removed and threshold filtering was applied correctly.
  \item Optionally saves the result as an `.RDS` file for reproducibility.
}

Warning messages will alert the user if any unexpected taxa or samples remain after filtering.
}
\section{Example}{

\dontrun{
# Load your phyloseq object
data("GlobalPatterns")

# Filter rare species and save the result
filtered_ps <- filter_phyloseq_data(GlobalPatterns, min_species_sum = 50)

# Load later:
restored_ps <- readRDS("phyloseq_filtered.RDS")
}
}

\seealso{
\code{\link[phyloseq]{prune_taxa}}, \code{\link[phyloseq]{prune_samples}}, \code{\link{prepare_long_data}}
}
